{% load static %}
<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8">
  <title>Cuenta Corriente Gardilcic</title>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">
</head>
<body>
<div class="container">
  <h1>Cuenta Corriente Gardilcic</h1>
  <a href="{% url 'menu_rental' %}" class="btn btn-outline-secondary mb-3">← Volver al Menú</a>

  {% if success %}
    <div class="alert alert-success">{{ success }}</div>
  {% endif %}

  <!-- ================== COMPRAS ================== -->
  <h2>Compras</h2>
  <form method="post" class="mb-3">
    {% csrf_token %}
    <input type="hidden" name="tipo" value="compra">
    <select name="mes" class="form-control mb-2">
      <option value="">Mes</option>
      {% for m in meses %}
        <option value="{{ m }}">{{ m }}</option>
      {% endfor %}
    </select>
    <input type="date" name="fecha" class="form-control mb-2">
    <input type="text" name="factura" placeholder="N° Factura" class="form-control mb-2">
    <input type="number" name="total" placeholder="Total" class="form-control mb-2">
    <input type="text" name="mensaje" placeholder="Mensaje" class="form-control mb-2">
    <select name="pagado" class="form-control mb-2">
      <option value="Sí">Pagado</option>
      <option value="No">No pagado</option>
    </select>
    <input type="date" name="fecha_pago" class="form-control mb-2">
    <select name="estado" class="form-control mb-2">
      <option value="Pendiente">Pendiente</option>
      <option value="Pagado">Pagado</option>
      <option value="Vencido">Vencido</option>
    </select>
    <button type="submit" class="btn btn-primary">Guardar Compra</button>
  </form>

  <table class="table table-bordered">
    <thead><tr><th>#</th><th>Mes</th><th>Factura</th><th>Total</th></tr></thead>
    <tbody>
      {% for c in compras %}
        <tr>
          <td>{{ forloop.counter }}</td>
          <td>{{ c.mes }}</td>
          <td>{{ c.factura }}</td>
          <td>${{ c.total|floatformat:0 }}</td>
        </tr>
      {% empty %}
        <tr><td colspan="4" class="text-center">No hay compras</td></tr>
      {% endfor %}
    </tbody>
  </table>

  <!-- ================== VENTAS ================== -->
  <h2>Ventas</h2>
  <form method="post" class="mb-3">
    {% csrf_token %}
    <input type="hidden" name="tipo" value="venta">
    <select name="mes" class="form-control mb-2">
      {% for m in meses %}
        <option value="{{ m }}">{{ m }}</option>
      {% endfor %}
    </select>
    <input type="number" name="total" placeholder="Total" class="form-control mb-2">
    <button type="submit" class="btn btn-primary">Guardar Venta</button>
  </form>

  <table class="table table-bordered">
    <thead><tr><th>#</th><th>Mes</th><th>Total</th></tr></thead>
    <tbody>
      {% for v in ventas %}
        <tr><td>{{ forloop.counter }}</td><td>{{ v.mes }}</td><td>${{ v.total| floatformat:0 }}</td></tr>
      {% empty %}
        <tr><td colspan="3" class="text-center">No hay ventas</td></tr>
      {% endfor %}
    </tbody>
  </table>

  <!-- ================== PAGOS ================== -->
  <h2>Pagos</h2>
  <form method="post" class="mb-3">
    {% csrf_token %}
    <input type="hidden" name="tipo" value="pago">
    <select name="mes" class="form-control mb-2">
      {% for m in meses %}
        <option value="{{ m }}">{{ m }}</option>
      {% endfor %}
    </select>
    <input type="number" name="total" placeholder="Total" class="form-control mb-2">
    <button type="submit" class="btn btn-primary">Guardar Pago</button>
  </form>

  <table class="table table-bordered">
    <thead><tr><th>#</th><th>Mes</th><th>Total</th></tr></thead>
    <tbody>
      {% for p in pagos %}
        <tr><td>{{ forloop.counter }}</td><td>{{ p.mes }}</td><td>${{ p.total|floatformat:0 }}</td></tr>
      {% empty %}
        <tr><td colspan="3" class="text-center">No hay pagos</td></tr>
      {% endfor %}
    </tbody>
  </table>
</div>
</body>
</html>